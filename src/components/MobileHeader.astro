---
const navItems = [
  { name: "Home", href: "/" },
  { name: "About", href: "/about" },
  { name: "Use Cases", href: "/use-cases" },
  { name: "Pricing", href: "/pricing" },
  { name: "Contact", href: "/contact" },
];

const currentPath = Astro.url.pathname;
---

<header
  class="fixed top-0 left-0 right-0 z-50 bg-white/95 backdrop-blur-md border-b border-gray-100 transition-all duration-300 h-16"
  id="mobile-header"
>
  <div class="container mx-auto px-4 h-full flex items-center justify-between">
    <!-- Logo -->
    <a
      href="/"
      class="flex items-center space-x-2 group cursor-pointer"
      aria-label="Spentiva Home"
    >
      <div class="w-8 h-8 flex items-center justify-center">
        <img
          src="/logo.svg"
          alt="Spentiva Logo"
          class="w-full h-full"
          width="32"
          height="32"
        />
      </div>
      <div class="flex flex-col">
        <span
          class="font-bold text-lg text-gray-900 tracking-tight leading-none"
          >Spentiva</span
        >
        <span
          class="text-[10px] tracking-widest text-gray-500 font-medium uppercase leading-none mt-1"
          >By Exyconn</span
        >
      </div>
    </a>

    <!-- Mobile Menu Button -->
    <button
      id="mobile-menu-toggle"
      class="p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500 relative w-10 h-10 flex items-center justify-center"
      aria-label="Toggle navigation menu"
      aria-expanded="false"
      aria-controls="mobile-menu-drawer"
    >
      <div
        class="cursor-pointer hamburger-icon w-5 h-4 relative flex flex-col justify-between"
      >
        <span
          class="w-full h-0.5 bg-current transform transition-all duration-300 origin-left"
        ></span>
        <span
          class="w-full h-0.5 bg-current transform transition-all duration-300 opacity-100"
        ></span>
        <span
          class="w-full h-0.5 bg-current transform transition-all duration-300 origin-left"
        ></span>
      </div>
    </button>
  </div>

  <!-- Mobile Navigation Drawer -->
  <div
    id="mobile-menu-drawer"
    class="fixed inset-x-0 top-16 bg-white/95 backdrop-blur-xl border-b border-gray-100 shadow-xl transform origin-top transition-all duration-300 ease-in-out opacity-0 scale-y-0 invisible"
    style="max-height: calc(100vh - 4rem); overflow-y: auto;"
  >
    <div class="container mx-auto px-4 py-6 space-y-4">
      <div class="flex flex-col space-y-2">
        {
          navItems.map((item) => (
            <a
              href={item.href}
              class={`cursor-pointer px-4 py-3 rounded-xl text-base font-medium transition-all duration-200 ${
                currentPath === item.href
                  ? "bg-primary-50 text-primary-600"
                  : "text-gray-600 hover:bg-gray-50 hover:text-primary-600"
              }`}
            >
              {item.name}
            </a>
          ))
        }
      </div>

      <div class="pt-4 border-t border-gray-100 grid grid-cols-2 gap-4">
        <a
          href="https://app.spentiva.com/login"
          class="cursor-pointer flex items-center justify-center px-4 py-3 border border-gray-200 text-gray-700 font-semibold rounded-xl hover:bg-gray-50 hover:border-gray-300 transition-all duration-200"
        >
          Log in
        </a>
        <a
          href="https://app.spentiva.com/signup"
          class="cursor-pointer flex items-center justify-center px-4 py-3 bg-primary-600 text-white font-semibold rounded-xl hover:bg-primary-700 shadow-lg shadow-primary-600/20 transition-all duration-200"
        >
          Sign up
        </a>
      </div>
    </div>
  </div>
</header>

<style>
  /* Hamburger Animation Classes */
  .menu-open .hamburger-icon span:nth-child(1) {
    transform: rotate(45deg);
  }
  .menu-open .hamburger-icon span:nth-child(2) {
    opacity: 0;
  }
  .menu-open .hamburger-icon span:nth-child(3) {
    transform: rotate(-45deg);
  }
</style>

<script>
  function initMobileMenu() {
    const toggleBtn = document.getElementById("mobile-menu-toggle");
    const drawer = document.getElementById("mobile-menu-drawer");

    if (!toggleBtn || !drawer) return;

    let isOpen = false;

    function setMenuState(open: boolean) {
      isOpen = open;
      toggleBtn?.setAttribute("aria-expanded", open.toString());

      if (open) {
        drawer?.classList.remove("invisible", "opacity-0", "scale-y-0");
        toggleBtn?.classList.add("menu-open");
      } else {
        drawer?.classList.add("invisible", "opacity-0", "scale-y-0");
        toggleBtn?.classList.remove("menu-open");
      }
    }

    // Clean up old listeners
    const newBtn = toggleBtn.cloneNode(true);
    toggleBtn.parentNode?.replaceChild(newBtn, toggleBtn);

    const activeBtn = document.getElementById("mobile-menu-toggle");

    activeBtn?.addEventListener("click", (e) => {
      e.stopPropagation();
      setMenuState(!isOpen);
    });

    document.addEventListener("click", (e) => {
      if (
        isOpen &&
        drawer &&
        activeBtn &&
        !drawer.contains(e.target as Node) &&
        !activeBtn.contains(e.target as Node)
      ) {
        setMenuState(false);
      }
    });
  }

  initMobileMenu();
  document.addEventListener("astro:page-load", initMobileMenu);
</script>
